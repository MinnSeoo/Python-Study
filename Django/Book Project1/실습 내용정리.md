## 프로젝트 / App 생성

프로젝트 생성시 

- django-admin startproject 프로젝트_명

APP 생성시  

- python3 manage.py startapp 앱_명

**이후 setting.py 파일에 app_명을 추가 시켜줘야함!**

<br>

## User 가 url 접근시 처리

url은 개발자가 어떻게 설정하느냐에 따라서 값이 달라짐. 

이번 프로젝트에서는 localhost에서 돌릴거기 때문에 크게 상관은 없음

user가 “” 라는 url( == localhost)에 접근했을때, My_Todo_App의 url.py 파일에서 처리하도록 넘겨줘야함.

**경로 : Todo_List/url.py  (project 파일에 존재하는 urls.py)**

- path(””, include(”My_Todo_App.urls”))
- import include  (위에서 include 함수를 사용하므로 import 해 줘야함.)

그리고 현재 App에는 urls.py 파일이 존재하지 않으므로 새롭게 생성해 줘야함.

**경로 : My_Todo_App/urls.py** 

파일을 생성한 후 아래와 같이 작성해 준다.

```python
from django.urls import path
from . import views  # 현재 경로에서 views 함수 import
 
urlpatterns = [
	path("",views.index)

]
```

<br>

## views 파일에서 html 파일 처리

html 파일을 템플릿으로 사용하려고 할때, 장고는 해당 앱에서 **templates라는 폴더를 탐색**함.

그리고 앱 이름과 동일한 폴더를 찾아 그 내부에 존재하는 html 파일을 열어서 불러옴. 

따라서 template 폴더 안에 My_Todo_App이라는 폴더를 생성한 후, 책에 작성된 git 주소에 가서 index.html 파일을 복사하여 붙여 넣기 해준다. 

그럼 이제 이 html 파일은 views에서 Import 하여 처리하기 때문에 views.py 에 아래와 같이 작성해준다.

```python
from django.shortcuts import render
from django.http import HttpResponse

# Create your views!
def index(render):
	return(request, "My_Todo_App/index.html")

```

- render 함수 → html 파일을 user들에게 시각적으로 보여주는 역할
- 인자값으로 request를 먼저 준 이유?
    - request를 통해 user들의 정보나 session 같은 중요한 값들을 전달해 주기 때문이다.
    - 즉, user가 url에 접속하면 index 함수가 실행되고, 이때 뒤에있는 url로 request를 받아와 
    중요한 값들을 참조할 수 있게끔 하는것이다.

<br>

## Models 파일

장고는 app의 **Models.py 파일**에서 **DB의 테이블을 정의**한다.

DB를 사용하기 전, 먼저 설정해 줘야 하는 부분이 2가지가 있다. 

→ 1) 어떠한 DB를 사용할 것인지 설정.

- 장고에선 default 값으로 SQLite를 사용. but, MySQL, 오라클..등 설치해 사용 가능!

→ 2) 해당 DB의 테이블에 대한 형태를 정의.

- 테이블 형태를 정의 한다? → Models.py 파일에서 테이블을 정의한다!

```python
# app / models.py
# 아래는 ToDo app에 필요한 데이터를 다룸.

from django.db import models

# Create your models here.
class Todo(models.Model):
	content = models.CharFild(max_length = 255)  

```

- 하나의 모델은 한 개의 클래스로 나타냄 
→ (즉, 위에선 Todo가 모델 명인 셈.)

- 클래스를 정의한 후, 내부에 데이터 명과 그 데이터의 형태를 정의하면 된다.

여태껏 다른 파일들은 수정만 하면 바로 적용이 되었지만은, model은 다르다. 

실제로 db에 적용시키기 위해서 아래와 같은 명령어를 사용해야 한다.

- python3 manage.py makemigrations (DB 초안? 뼈대 구축..? 작업)
    
    → app 폴더 내부에 migrations 라는 폴더가 생성됨.
    
- python3 manage. py migrate (실제 DB 적용됨)

<br>

## SQLite 접근 및 명령어

db에 접근하기 위해선 먼저 sqlite에 접속을 해 줘야 한다.

→ python3 manage.py dbshell

접속 후 데이터가 잘 존재하는지 쿼리문을 날려보자!

→ .tables 

- 해당 db에 존재하는 테이블 명을 모두 출력.
    - 테이블 명에는 규칙 존재 → <프로젝트_명>_<모델_명>

→ PRAGMA table_info(My_Todo_App_todo);

- 해당 테이블이 어떠한 정보를 가지는지 확인.

![image](https://github.com/MinnSeoo/TIL/assets/102645965/3a8c966b-1965-4e9b-9835-62ee2f6dff32)


그럼 위와 같이 출력이 된다. 

> 💡 순서 | 이름 | 형태 | notnull 여부 | pk 여부
> 

notnull : 해당 값이 비어 있어도 되는지의 여부 

pk : primary key의 약어로, 테이블 내에서 각 데이터를 유일하게 식별할 수 있는 값인지에 대한 여부이다.

- **1이면 비어있으면 안됨.**
- **0이면 비어있어도 됨.**

## 메모하기 버튼 클릭시, 데이터 전달후 해당 url로 이동

![image](https://github.com/MinnSeoo/TIL/assets/102645965/b6375764-b416-4abb-ad52-ad48d853c6b4)


위 img의 메모하기! 버튼을 클릭시 server에게 해당 데이터가 전달이 되고, 해당 url로 이동하는 작업을 할것이다!

일단 index.html 파일에서 form 태그의 action과 method에 대하여 설정해 줘야 한다.
```html
<form action="./createTodo/" method="POST">{% *csrf_token* %}
```
→ action : 서버로 데이터 전달시 어떤 경로(url)에 데이터를 전달할 것인지 나타냄.

→ method : POST 방식을 사용해야 함. (Post 방식 사용시 뒤에 token 값을 꼭 적어줘야함.)

이 상태로 서버를 실행시킨 후 “메모하기! “ 버튼을 눌러보면?  → 당연히 404 error가 발생한다. 

404 error란 해당 페이지가 존재하지 않는다는 에러이다.  

(server 입장에서는 현재의 url을 어디에 처리를 맡겨야 할지 잘 모르는 상태.)

현재 상황에서는 당연히 발생할 수 밖에 없다. 

**→ 우리는 url.py에 createTodo 라는 경로를 작성해 주지 않았기 때문이다.**

자 이제, 작성해 보자^^

```python
# ToDo_List/My_Todo_List/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path("",views.index),
    path("createTodo/", views.createTodo)       # 추가된 코드 
]
```

위에서 추가된 코드의 의미는, createToDo 라는 경로에 접근하게 되면 views. py 파일에서 createTodo라는 
함수에서 처리해줘! 라는 의미이다.

이렇게만 작성해 주면 “views.createTodo” 이 부분에 밑줄이 쳐진 상태일것이다. 

그 이유는 views.py 파일에 createTodo 함수가 작성되어 있지 않기 때문이다. 

따라서 views 파일로 이동해 함수를 작성해 주자.

```python
# ToDo_List/My_Todo_List/views.py

from django.shortcuts import render
from django.http import HttpResponse

# Create your views here.
def index(request):
    return render(request, 'My_Todo_App/index.html')     

def createTodo(request):
    return HttpResponse("Create Todo!")      # 추가된 코드              
```

추가된 코드를 통해,사용자가 createTodo 라는 경로로 이동시 “Create Todo!” 라는 문자열을 해당 페이지에 띄어준다.